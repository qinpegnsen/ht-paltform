
<div class="szh-order-info position-relative b">
  <div class="szh-order-details w40">
    <div class="order-head p bb text-info"><i class="fa fa-file-text"></i> 订单信息</div>
    <div class="content p-lg">
      <dl>
        <dt>买家姓名：</dt>
        <dd>{{orderDetailData.linkman}}</dd>
      </dl>
      <dl>
        <dt>联系电话：</dt>
        <dd>{{orderDetailData.phone}}</dd>
      </dl>
      <dl>
        <dt>收货地址：</dt>
        <dd>{{orderDetailData.areaFullName}} {{orderDetailData.addr}}</dd>
      </dl>
      <dl>
        <dt>支付方式：</dt>
        <dd>{{orderDetailData.payWay | rzhState:'1017'}}</dd>
      </dl>
      <ng-container *ngIf="logisticsInfo">
        <dl>
          <dt>物流公司：</dt>
          <dd>{{logisticsInfo.expressName}}</dd>
        </dl>
        <dl>
          <dt>快递单号：</dt>
          <dd>{{logisticsInfo.expressNo}}</dd>
        </dl>
      </ng-container>
      <dl class="line pt-lg">
        <dt>订单编号：</dt>
        <dd>{{orderDetailData.ordno}}
          <span class="pull-right" (mouseenter)="showTimeList(times)"
                (mouseleave)="hideTimesList(times)"
                myHoverColor
                [myHover]="'#CC1635'">更多<i
            class="fa fa-angle-down time-list"></i>
          </span>
          <div class="more b w100" #times (mouseenter)="showTimeList(times)" (mouseleave)="hideTimesList(times)"><span
            class="arrow"></span>
            <ul class="list-unstyled font12 mb0">
              <li *ngIf="!orderStates"><span>{{orderDetailData.createTime}}</span> 创建订单</li>
              <li *ngFor="let item of orderStates"><span>{{item.createTime}}</span>{{item.state=='DELIVERY'?'已发货':item
                .description}}</li>
            </ul>
          </div>
        </dd>
      </dl>
    </div>
  </div>
  <div class="szh-order-condition bl">
    <div class="order-head p bb text-info"><i class="fa fa-truck"></i> 物流信息</div>
    <!--订单跟踪-->
    <div class="order-track">
      <ul class="timeline-alt pb0 mb0">
        <li class="mb0" *ngFor="let item of orderStates">
          <div class="timeline-badge primary">
            <em class="fa fa-truck"></em>
          </div>
          <div class="timeline-panel">
            <div class="right" >
              <div>
                <p *ngIf="item.state!='DELIVERY'">
                  <span class="mr">{{item.createTime}}</span>
                  <span>{{item.description}}</span>
                </p>
                <p *ngFor="let detail of item.traceVos;let i=index;">
                  <span class="mr" >{{detail.acceptTime}}</span>
                  <span>{{detail.acceptStation}}</span>
                </p>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
<div class="rate-of-progress mt-xl mb-xl w100">
  <div class="szh-progress-bar w90">
    <div class="already-progress" [class.w1]="orderStep==1" [class.w25]="orderStep==2" [class.w50]="orderStep==3"
         [class.w75]="orderStep==4" [class.w100]="orderStep==5"></div>
  </div>
  <dl class="cur">
    <dt>提交订单</dt>
    <dd class="szh-progress-point fa fa-check mt mb-lg"></dd>
    <dd>{{orderStates[0].createTime}}</dd>
  </dl>
  <dl [class.cur]="orderStep==2 || orderStep==3 || orderStep==4 || orderStep==5">
    <dt>已支付</dt>
    <dd class="szh-progress-point fa fa-check mt mb-lg"></dd>
    <dd>{{orderStates[1].createTime}}</dd>
  </dl>
  <dl [class.cur]="orderStep==3 || orderStep==4 || orderStep==5">
    <dt>已配货</dt>
    <dd class="szh-progress-point fa fa-check mt mb-lg"></dd>
    <dd>{{orderStates[2].createTime}}</dd>
  </dl>
  <dl [class.cur]="orderStep==4 || orderStep==5">
    <dt>已发货</dt>
    <dd class="szh-progress-point fa fa-check mt mb-lg"></dd>
    <dd>{{orderStates[3].createTime}}</dd>
  </dl>
  <dl [class.cur]="orderStep==5">
    <dt>订单完成</dt>
    <dd class="szh-progress-point fa fa-check mt mb-lg"></dd>
    <dd>{{orderStates[4].createTime}}</dd>
  </dl>
</div>


<div class="w100">
  <table class="w100 b">
    <thead class="w100">
    <tr class="w100 order-head">
      <th class="w50 p text-center">商品</th>
      <th class="w10 p text-center">单价(元)</th>
      <th class="w10 p text-center">数量</th>
      <th class="w10 p text-center">订单金额(元)</th>
      <th class="w10 p text-center">交易操作</th>
    </tr>
    </thead>
    <tbody>
    <tr class="text-center" *ngFor="let goods of goodsData;let i = index">
      <td class="text-left p position-relative bb">
          <span class="goods-img goods-md-img mr"><img [src]="goods.goodsImage"
                                                       onerror="javascript:this.src='../../../assets/img/dummy.png'"
                                                       alt=""></span>
        <div class="goods-md-info">
          <p class="mb0 font13 omg2 two-row mb-sm">
            <a class="goods-name" href="javascript:;">{{goods.goodsName}}</a>
          </p>
          <p class="mb0 one-row omg font12">
            <span class="inline">颜色：</span>
            <span class="inline">红色</span>
          </p>
        </div>
      </td>
      <td class="bb">{{goods.price | decimalTwo}}</td>
      <td class="bb">{{goods.num}}</td>
      <ng-container *ngIf="i == 0">
        <td class="bl" [attr.rowspan]="goodsData.length">
          <span class="main-red font14">¥{{goodsData.pay | decimalTwo}}</span><br>
          <span class="font-gray">（免运费）</span><br>
          <span class="font-gray">{{goodsData.payWay | rzhState:'1017'}}</span>
        </td>
        <td class="bl" [attr.rowspan]="goodsData.length">
          <p class="font-gray mb-sm cursor-p">{{goodsData.state | rzhState:'1019'}}</p>
          <!--<button class="m-sm btn btn-xs btn-warning fa fa-ban"> 取消订单</button>-->
          <button class="m-sm btn btn-xs btn-green fa fa-truck" *ngIf="goodsData.state=='PREPARE'"> 发货</button>
          <!--<button class="m-sm btn btn-xs btn-danger fa fa-retweet"> 退款</button>-->
        </td>
      </ng-container>
    </tr>
    </tbody>
    <tfoot>
    <tr>
      <td colspan="10" class="gray-bg order-footer p-sm pr-xl font12">
        <dl class="text-right mb0">
          <dt>运费：</dt>
          <dd><span class="main-red font18">{{goodsData.freight == 0? '(免运费)':goodsData.freight | decimalTwo}}</span>元</dd>
        </dl>
        <dl class="text-right mb0">
          <dt>订单应付金额：</dt>
          <dd><span class="main-red font20">{{goodsData.total | decimalTwo}}</span>元</dd>
        </dl>
      </td>
    </tr>
    </tfoot>
  </table>
</div>
<ng-container *ngIf="goodsData.state=='PREPARE'">
  <app-deliver-goods [orderId]="curDeliverOrderId"
                     (deliverGoods)="getDeliverOrderData($event)"></app-deliver-goods>
</ng-container>

