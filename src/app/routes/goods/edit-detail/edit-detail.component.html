<form class="step-two panel panel-default" [formGroup]="valForm" #publishForm="ngForm">
  <!--商品基本信息-->
  <fieldset class="m0 p0">
    <legend class="m0">商品基本信息</legend>
    <dl class="clearfix">
      <dt class="col-xs-2">商品分类：</dt>
      <dd class="col-xs-10">
        <span>{{goodsKind}}</span>
        <button class="btn btn-info btn-sm ml" routerLink="../step_one">选择分类</button>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2"><i>*</i>商品名称：</dt>
      <dd class="col-xs-10 col-md-8">
        <div class="w60">
          <input type="text" required name="" class="form-control">
        </div>
        <p class="tip">商品标题名称长度至少3个字符，最长50个汉字</p>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">商品卖点：</dt>
      <dd class="col-xs-10 col-md-8">
        <div class="w60">
          <textarea class="form-control" name="" id="" cols="10" rows="3"></textarea>
        </div>
        <p class="tip">商品卖点可填写商品的简介或特点，最长不能超过140个汉字</p>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">商品品牌：</dt>
      <dd class="col-xs-10 col-md-8">
        <div class="w60">
          <select class="form-control" name="">
            <option *ngFor="let brand of brandsList" [value]="brand.id">{{brand.brandName}}</option>
          </select>
        </div>
        <p class="tip">选择您的商品品牌，有利于商品通过品牌索引方式被找到；如没有您想要的品牌，可从“品牌管理”功能中添加并提交后台审核后再选择。</p>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">商品属性：</dt>
      <dd class="col-xs-10">
        <div class="w80 clearfix">
          <label class="col-sm-4">
            <span class="col-xs-3 pl-sm pr-sm pro-name">衣长</span>
            <div class="col-xs-9 pl-sm pr-sm">
              <select class="form-control" name="">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
              </select>
            </div>
          </label>
          <label class="col-sm-4 col-xs-6">
            <span class="col-xs-3 pl-sm pr-sm pro-name">衣长</span>
            <div class="col-xs-9 pl-sm pr-sm">
              <select class="form-control" name="">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
              </select>
            </div>
          </label>
          <label class="col-sm-4 col-xs-6">
            <span class="col-xs-3 pl-sm pr-sm pro-name">衣长</span>
            <div class="col-xs-9 pl-sm pr-sm">
              <select class="form-control" name="">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
              </select>
            </div>
          </label>
        </div>
        <p class="tip" [class.tip-active]="hover">正确选择商品属性直接影响搜索筛选的准确与否，请根据实际情况认真选择填写。</p>
      </dd>
    </dl>
  </fieldset>

  <!--商品交易信息-->
  <fieldset class="m0 p0">
    <legend class="m0">商品交易信息</legend>
    <dl class="clearfix">
      <dt class="col-xs-2"><i>*</i>计量单位：</dt>
      <dd class="col-xs-10 col-md-8">
        <div class="w60">
          <select name="" required class="form-control">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </div>
        <p class="tip">请正确该商品的单位描述，确保购买者明确商品对应单价/计量单位。</p>
      </dd>
    </dl>
  </fieldset>

  <!--商品规格及图片-->
  <fieldset class="m0 p0">
    <legend class="m0">商品规格及图片</legend>
    <dl class="clearfix">
      <dt class="col-xs-2">商品规格：</dt>
      <dd class="col-xs-10 specs">
        <h5 class="clearfix m0">
          <span class="col-sm-2 col-xs-3 text-right">规格</span>
          <span class="col-sm-10 col-xs-9">规格值 <em>（通过选择规格值建立商品与商品规格的关系）</em></span>
        </h5>
        <form class="clearfix enumType" *ngFor="let enumType of enumTypes;let i = index;" [id]="i+1">
          <h6 class="col-sm-2 col-xs-3 text-right">
            <span class="_attrName">{{enumType.name}}</span>
            <label class="w80 hide"><input class="form-control" name="enumName" type="text" [id]="enumType.id"
                                           [value]="enumType.name" (change)="changeSpecAttr($event.target)"></label>
          </h6>
          <ul class="col-sm-10 col-xs-9 p">
            <li class="col-xs-4 col-md-3 _attr" *ngFor="let val of enumType.goodsEnumValList">
              <label class="checkbox-inline c-checkbox">
                <input class="_val" type="checkbox" [name]="enumType.name" [id]="val.id" [value]="val.enumValue"
                       (change)="checkSpecVal($event.target)"
                />
                <span class="fa fa-check"></span>
              </label>
              <span class="_value">{{val.enumValue}}</span>
              <label class="w66 hide">
                <input class="form-control" type="text" [name]="val.idx" [id]="val.id" [value]="val.enumValue"
                       (change)="changeSpecVal($event.target)">
              </label>
            </li>
          </ul>
        </form>
        <p class="tip">
          可勾选商品对应的规格及规格值，规格及规格值名称都可以自定义；当勾选两种不同规格的规格值后将组合成一种商品SKU，可从下方表格中进行具体设定。
        </p>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">商品价格及库存：</dt>
      <dd class="col-xs-10">
        <table class="sku-table w100">
          <thead>
          <!--当没有选择规格时-->
          <tr class="text-center" *ngIf="skuAttr.length == 0">
            <th [class.col-xs-2]="skuAttr"><i>*</i>市场价 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置市场价</p>
                <div class="text-center">
                  <input class="_price marketPrice" name="marketPrice" type="text" placeholder="0.00">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
            <th [class.col-xs-2]="skuAttr"><i>*</i>销售价 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置销售价</p>
                <div class="text-center">
                  <input class="_price price" name="price" type="text" placeholder="0.00">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
            <th [class.col-xs-2]="skuAttr"><i>*</i>会员价 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置会员价</p>
                <div class="text-center">
                  <input class="_price memberPrice" name="memberPrice" type="text" placeholder="0.00">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
            <th class="col-xs-2"><i>*</i>库存 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置库存</p>
                <div class="text-center">
                  <input class="_price memberPrice" name="stock" type="text" placeholder=">10">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
          </tr>

          <!--当选择了规格时-->
          <tr class="text-center" *ngIf="skuAttr.length > 0">
            <th class="col-xs-2" *ngFor="let attr of skuAttr"
                [id]="attr.attrCode">{{attr.attrName}}</th>
            <th [class.col-xs-2]="skuAttr"><i>*</i>市场价 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置市场价</p>
                <div class="text-center">
                  <input class="_price marketPrice" name="marketPrice" type="text" placeholder="0.00">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
            <th [class.col-xs-2]="skuAttr"><i>*</i>销售价 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置销售价</p>
                <div class="text-center">
                  <input class="_price price" name="price" type="text" placeholder="0.00">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
            <th [class.col-xs-2]="skuAttr"><i>*</i>会员价 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置会员价</p>
                <div class="text-center">
                  <input class="_price memberPrice" name="memberPrice" type="text" placeholder="0.00">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
            <th class="col-xs-2"><i>*</i>库存 <em class="icon-note cursor-p s-menu"></em>
              <div class="dropdown-menu animated fadeInDown pl pr" role="menu">
                <div class="close">×</div>
                <p>批量设置库存</p>
                <div class="text-center">
                  <input class="_price memberPrice" name="stock" type="text" placeholder=">10">
                  <button class="btn btn-green btn-sm set">设置</button>
                </div>
              </div>
            </th>
          </tr>
          </thead>
          <tbody>
          <!--当没有选择规格时-->
          <tr *ngIf="skuVal.length == 0" class="text-center">
            <td>
              <input class="text _price num" name="marketPrice" required type="number">
              <em class="add-on">元</em>
            </td>
            <td>
              <input class="text _price num" name="price" required type="number" >
              <em class="add-on">元</em>
            </td>
            <td>
              <input class="text _price num" name="memberPrice" required type="number">
              <em class="add-on">元</em>
            </td>
            <td>
              <input class="text stock num" name="stock" type="number" required value="10" formControlName="minvalue"
                     [formControl]="valForm.controls['minvalue']" >
              <span class="text-danger"
                    *ngIf="valForm.controls['minvalue'].hasError('min') && (valForm.controls['minvalue'].dirty || valForm.controls['minvalue'].touched)">库存最少为10 </span>
            </td>
          </tr>

          <!--当选择了规格时-->
          <tr *ngFor="let sku of skuVal">
            <td *ngFor="let val of sku" [id]="val.valCode" [class]="val.idx"><p>{{val.value}}</p></td>
            <td>
              <input class="text _price num" name="marketPrice" type="number" required placeholder="0.00">
              <em class="add-on">元</em>
            </td>
            <td>
              <input class="text _price num" name="price" type="number" required placeholder="0.00">
              <em class="add-on">元</em>
            </td>
            <td>
              <input class="text _price num" name="memberPrice" type="number" required placeholder="0.00">
              <em class="add-on">元</em>
            </td>
            <td>
              <input class="text stock num" name="stock" type="number" value="10" required formControlName="minvalue"
                     [formControl]="valForm.controls['minvalue']" >
              <span class="text-danger"
                    *ngIf="valForm.controls['minvalue'].hasError('min') && (valForm.controls['minvalue'].dirty || valForm.controls['minvalue'].touched)">库存最少为10 </span>
            </td>
          </tr>
          </tbody>
        </table>
        <p class="tip"> 点击 <em class="icon-note"></em> 可批量修改所在列的值。 <br>
          当规格值较多时，可在操作区域通过滑动滚动条查看超出隐藏区域。</p>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2"><i>*</i>商品图片：</dt>
      <dd class="col-xs-10 pic-list">
        <!--当没有选择第一规格时-->
        <div class="goodspics" *ngIf="skuImg.vals.length == 0">
          <div class="color-value mr">
            <h4>默认：</h4>
            <label class="btn btn-sm btn-info file-upload">
              <em class="fa fa-picture-o"></em>
              打开相册图片
              <input class="w100" type="file" accept="image/*" name="" ng2FileSelect [uploader]="defaultUploader" multiple/>
            </label>
          </div>
          <ul class="goods-pic-list">
            <li class="ui-state-disabled" *ngIf="defaultUploader.queue.length == 0">
              <div class="upload-thumb">
                <img src="../../../assets/img/dummy.png">
              </div>
            </li>
            <li class="ui-state-disabled img-box" *ngFor="let item of defaultUploader.queue">
              <div class="close" *ngIf="!item.isSuccess" (click)="item.remove()">×</div>
              <div class="upload-thumb">
                <div class="up-success" *ngIf="item.isSuccess"><em class="fa fa-check"></em></div>
                <img *ngIf="item" [src]="item._file | imgUrl" onerror="javascript:this.src='../../../assets/img/dummy.png'" [alt]="item?.file?.name">
              </div>
            </li>
          </ul>
        </div>

        <!--当选择了第一规格时-->
        <div class="goodspics" *ngFor="let val of skuImg.vals" [id]="val.valCode">
          <div class="color-value">
            <h4>{{skuImg.attrName}}：<span data-spec-value-name="23">{{val.valName}}</span></h4>
            <label class="btn btn-sm btn-info file-upload">
              <em class="fa fa-picture-o"></em>
              打开相册图片
              <input class="w100" type="file" accept="image/*" name="" ng2FileSelect
                     [uploader]="val.uploader" multiple/>
            </label>
          </div>
          <ul class="goods-pic-list ml">
            <li class="ui-state-disabled" *ngIf="val.uploader.queue.length == 0">
              <div class="upload-thumb">
                <img src="../../../assets/img/dummy.png">
              </div>
            </li>
            <li class="ui-state-disabled img-box" *ngFor="let item of val.uploader.queue">
              <div class="close" *ngIf="!item.isSuccess" (click)="item.remove()">×</div>
              <div class="upload-thumb">
                <div class="up-success" *ngIf="item.isSuccess"><em class="fa fa-check"></em></div>
                <img *ngIf="item" [src]="item._file | imgUrl" onerror="javascript:this.src='../../../assets/img/dummy.png'" [alt]="item?.file?.name">
              </div>
            </li>
          </ul>
        </div>
      </dd>
    </dl>
  </fieldset>

  <!--商品详情描述-->
  <fieldset class="m0 p0">
    <legend class="m0">商品详情描述</legend>
    <dl class="clearfix">
      <dt class="col-xs-2">商品描述：</dt>
      <dd class="col-xs-10">
        <div class="w100">
          <div id="summernote" class="summernote">
            <span>Rich text presentation here..</span>
          </div>
        </div>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">移动端描述：</dt>
      <dd class="col-xs-10">
        <div class="w100 app-box">
          <div class="app-wrap">
            <div class="app-control">
              <div class="app-content">
                <div class="app-img-box" *ngFor="let item of mblItemList;let i=index;">
                  <div class="_edit hide">
                    <ul class="tools pull-right">
                      <li class="btn p0 mr-sm btn-default" *ngIf="i != 0" (click)="moveImg(i,'up',item)">上移</li>
                      <li class="btn p0 mr-sm btn-default" *ngIf="i != mblItemList.length-1"
                          (click)="moveImg(i,'down',item)">下移
                      </li>
                      <li class="btn p0 mr-sm btn-default" *ngIf="item.type== 'img'">
                        <label class="file-upload mb0">替换
                          <input class="w100" type="file" accept="image/*" name="appPic"
                                 (change)="mblReplaceImg($event,i)"/>
                        </label>
                      </li>
                      <li class="btn p0 mr-sm btn-default" *ngIf="item.type== 'text'"
                          (click)="mblReplaceText($event.target,i,item.value)">编辑
                      </li>
                      <li class="btn p0 mr-sm btn-default" (click)="removeItem(i)">移除</li>
                    </ul>
                  </div>
                  <img width="100%" *ngIf="item.type== 'img'" [src]="item.value"
                        onerror="javascript:this.src='../../../assets/img/dummy.png'">
                  <p class="text mb0" style="line-height: 1.6" *ngIf="item.type== 'text'">{{item.value}}</p>
                  <div class="mobile-edit-area mt hide" *ngIf="item.type== 'text'">
                    <div class="mea-text">
                      <div class="pl pr"><textarea class="textarea valid form-control p-sm" rows="3"
                                                   (keyup)="counter($event.target)"></textarea></div>
                      <div class="button">
                        <a class="btn btn-sm btn-primary" (click)="insertText($event.target)" href="javascript:void(0);">确认</a>
                        <a class="btn btn-sm btn-default ml" (click)="hideEdit($event.target)" href="javascript:void(0);">取消</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mobile-edit-area mt hide">
                <div class="mea-text">
                  <p class="text-tip">还可以输入 <i class="counter">500</i>字 </p>
                  <div class="pl pr"><textarea class="textarea valid form-control p-sm" rows="3"
                                               (keyup)="counter($event.target)"></textarea></div>
                  <div class="button">
                    <a class="btn btn-sm btn-primary" (click)="insertText($event.target)" href="javascript:void(0);">确认</a>
                    <a class="btn btn-sm btn-default ml" (click)="hideEdit($event.target)" href="javascript:void(0);">取消</a>
                  </div>
                </div>
              </div>
            </div>
            <ul class="app-add clearfix">
              <li class="col-xs-6">
                <label class="file-upload mb0">
                  <em class="fa fa-picture-o font24"></em><br>图片
                  <input class="w100" type="file" accept="image/*" name="appPic" ng2FileSelect
                         [uploader]="mobileUploader" multiple/>
                </label>
              </li>
              <li class="col-xs-6" (click)="showEdit()">
                <em class="fa fa-font font24"></em><br>文字
              </li>
            </ul>
          </div>
          <div class="explain">
            <dl class="mb">
              <dt>1、基本要求：</dt>
              <dd>建议：所有图片都是本宝贝相关的图片。</dd>
            </dl>
            <dl class="mb">
              <dt>2、图片大小要求：</dt>
              <dd>（1）建议使用宽度超过480像素、高度超过960像素的图片；</dd>
              <dd>（2）格式为：jpg\gif\png；</dd>
              <dd>举例：可以上传一张宽度为480，高度为960像素，格式为jpg的图片。</dd>
            </dl>
            <dl class="mb">
              <dt>3、文字要求：</dt>
              <dd>（1）每次插入文字不能超过500个字，标点、特殊字符按照一个字计算；</dd>
              <dd>（2）请手动输入文字，不要复制粘贴网页上的文字，防止出现乱码；</dd>
              <dd>（3）请注意特殊字符将会被转译。</dd>
              <dd>建议：不要添加太多的文字，这样看起来更清晰。</dd>
            </dl>
          </div>
        </div>
      </dd>
    </dl>
  </fieldset>

  <!--商品物流信息-->
  <fieldset class="m0 p0 logistics">
    <legend class="m0">商品物流信息</legend>
    <dl class="clearfix">
      <dt class="col-xs-2">运费：</dt>
      <dd class="col-xs-10 col-md-8">
        <div class="w90">
          <div class="mb">
            <span class="radio c-radio c-radio-nofont radio-box">
              <label>
              <input type="radio" name="freight" value="Y" checked="checked"/>
              <span class="fa fa-circle"></span>使用固定运费</label>
            </span>
            <span class="clearfix">
              <input class="text price num" name="" type="number" value="0">
              <em class="add-on">元</em>
            </span>
          </div>
          <div>
            <span class="radio c-radio c-radio-nofont radio-box">
              <label>
              <input type="radio" name="freight" value="N" />
              <span class="fa fa-circle"></span>使用物流规则</label>
            </span>
            <span>
              <select class="rules-list" name="">
                <option value="">-请选择-</option>
                <option value="0">0</option>
                <option value="1">1</option>
              </select>
            </span>
            <span class="btn btn-green btn-sm"><em class="fa fa-truck"></em> 添加物流规则</span>
          </div>
        </div>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">物流参数：</dt>
      <dd class="col-xs-10">
        <div class="w60">
          <div class="clearfix mb">
            <span class="pull-left mr">重量：</span>
             <span class="pull-left">
              <input class="text weight num" name="" type="number" value="1.00">
              <em class="add-on">kg</em>
            </span>
          </div>
          <div class="clearfix">
            <span class="pull-left mr">体积：</span>
             <span class="pull-left">
              <input class="text weight num" name="" type="number" value="1.00">
              <em class="add-on">m³</em>
            </span>
          </div>
        </div>
        <p class="tip">如选择物流规则具有体积或重量运费时，需设定商品物流参数，默认为“1”单位，小数点后保留2位。</p>
      </dd>
    </dl>
  </fieldset>

  <!--商品其他信息-->
  <fieldset class="m0 p0 others-info">
    <legend class="m0">其他信息</legend>
    <dl class="clearfix">
      <dt class="col-xs-2">商品发布：</dt>
      <dd class="col-xs-10">
        <div class="w60">
          <label class="radio-inline c-radio">
            <input type="radio" name="publish" value="Y" checked="checked" />
            <span class="fa fa-circle"></span>立即发布</label>
          <label class="radio-inline c-radio">
            <input type="radio" name="publish" value="N" />
            <span class="fa fa-circle"></span>放入仓库</label>
        </div>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">商品推荐：</dt>
      <dd class="col-xs-10">
        <div class="w60">
          <label class="radio-inline c-radio">
            <input type="radio" name="recommend" value="Y" checked="checked" />
            <span class="fa fa-circle"></span>推荐</label>
          <label class="radio-inline c-radio">
            <input type="radio" name="recommend" value="N" />
            <span class="fa fa-circle"></span>不推荐</label>
        </div>
      </dd>
    </dl>
    <dl class="clearfix">
      <dt class="col-xs-2">是否参加促销活动：</dt>
      <dd class="col-xs-10">
        <div class="w60">
          <label class="radio-inline c-radio">
            <input type="radio" name="promotion" value="Y" checked="checked" />
            <span class="fa fa-circle"></span>是</label>
          <label class="radio-inline c-radio">
            <input type="radio" name="promotion" value="N" />
            <span class="fa fa-circle"></span>否</label>
        </div>
        <p class="tip">请选择您的商品是否参加促销活动，如选择“否”，当您参加活动时将不能选择该商品。</p>
      </dd>
    </dl>
  </fieldset>

  <fieldset class="pt-xl m0 text-center">
    <button class="btn btn-green" type="button" [disabled]="!publishForm.form.valid">
      <em class="fa fa-upload mr"></em>发布商品</button>
    <button class="btn btn-green" type="button" (click)="uploadImgs()">
      <em class="fa fa-upload mr"></em>上传图片</button>
  </fieldset>

</form>
